<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-DPR">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì •ë™ìœ¤ ê²Œì„ì¦ˆ - ë©€í‹° ê²Œì„!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #6B778D 0%, #3E4A5F 100%); 
            margin: 0;
            overflow: hidden; 
            touch-action: manipulation; 
        }

        .screen {
            width: 100%;
            height: 100%;
            display: none; 
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
            position: absolute; 
            top: 0;
            left: 0;
            opacity: 0; 
            transition: opacity 0.5s ease-in-out; 
        }

        .screen.active {
            display: flex; 
            opacity: 1; 
        }

        /* --- ë‹‰ë„¤ì„ ì„¤ì • í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #nicknameSetupScreen {
            background: linear-gradient(145deg, #3E4A5F 0%, #2C3E50 100%);
            color: white;
        }
        .setup-container {
            text-align: center;
            animation: fadeInSlideUp 0.8s ease-out forwards;
        }
        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .setup-logo { 
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            opacity: 0; 
            animation: appleHelloAnimation 1.2s 0.5s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
        }
        @keyframes appleHelloAnimation { 
            0% { opacity: 0; transform: translateY(25px) scale(0.7) rotate(-10deg); }
            30% { opacity: 0.6; transform: translateY(-8px) scale(1.05) rotate(5deg); }
            60% { opacity: 1; transform: translateY(2px) scale(0.95) rotate(-2deg); }
            100% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
        }
        .setup-welcome {
            font-size: 1.5rem;
            margin-bottom: 20px; 
            animation: textAppear 1s 1s ease-out forwards; 
            opacity: 0;
        }
        @keyframes textAppear {
            to { opacity: 1; }
        }
        #nicknameInput {
            width: 80%;
            max-width: 300px;
            padding: 15px;
            margin-bottom: 15px; 
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            text-align: center;
            background-color: rgba(255,255,255,0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            animation: inputAppear 1s 1.5s ease-out forwards; 
            opacity: 0;
        }
        @keyframes inputAppear {
            to { opacity: 1; }
        }
        .nickname-buttons-container { 
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px; 
            animation: buttonAppear 1s 2s ease-out forwards; 
            opacity: 0;
        }
         @keyframes buttonAppear {
            to { opacity: 1; }
        }
        #confirmNicknameButton, #suggestNicknameButton {
            color: white;
            font-size: 1.1rem; 
            font-weight: 600;
            padding: 12px 25px; 
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease-out;
            width: 80%;
            max-width: 250px; 
        }
        #confirmNicknameButton {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        #suggestNicknameButton { 
            background: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
            box-shadow: 0 5px 15px rgba(247, 151, 30, 0.3);
        }
        #confirmNicknameButton:hover, #suggestNicknameButton:hover { transform: translateY(-2px); }
        #confirmNicknameButton:active, #suggestNicknameButton:active { transform: translateY(0px); }
        
        #nicknameSuggestions {
            margin-top: 15px;
            font-size: 0.9rem;
            color: #e0e0e0;
            min-height: 20px; 
        }
        #nicknameSuggestions button {
            background-color: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            padding: 5px 10px;
            margin: 3px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #nicknameSuggestions button:hover {
            background-color: rgba(255,255,255,0.4);
        }
        .loading-indicator {
            font-size: 0.9rem;
            margin-top: 10px;
            display: none; 
        }


        /* --- í™ˆ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #homeScreen {
             background: linear-gradient(135deg, #b0bec5 0%, #78909c 100%);
        }
        .home-content {
            text-align: center;
            background-color: rgba(255, 255, 255, 0.35); 
            backdrop-filter: blur(16px); 
            border-radius: 28px; 
            padding: 25px 40px; /* íŒ¨ë”© ì¡°ì • */
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15), 
                        inset 0 1px 1px rgba(255, 255, 255, 0.2), 
                        0 0 0 1.5px rgba(255, 255, 255, 0.25); 
            width: 90%;
            max-width: 500px; 
        }
        .app-title { 
            font-size: 2.2rem; 
            font-weight: 700; 
            margin-bottom: 8px; /* ê°„ê²© ì¡°ì • */
            color: #1A202C;
            text-shadow: 0 1px 2px rgba(255,255,255,0.1);
        }
        .app-subtitle { font-size: 1.1rem; margin-bottom: 15px; color: #374151; } /* ê°„ê²© ì¡°ì • */
        .game-selection-buttons { display: flex; flex-direction: column; gap: 12px; align-items: center; margin-bottom: 15px;} /* ê°„ê²© ì¡°ì • */
        .game-select-button { 
            color: white; font-size: 1.1rem; font-weight: 600; padding: 10px 20px; 
            border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s ease-out;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2); outline: none; background-size: 200% 200%; 
            animation: rainbowMove 4s ease infinite; -webkit-tap-highlight-color: transparent;
            width: 90%; max-width: 280px;
        }
        .game-select-button:hover { transform: translateY(-3px) scale(1.03); box-shadow: 0 10px 20px rgba(0,0,0,0.25); }
        .game-select-button:active { transform: translateY(1px) scale(0.98); box-shadow: 0 3px 6px rgba(0,0,0,0.25); }
        #startClickerGameButton { background: linear-gradient(135deg, #4285F4 0%, #9B72F5 50%, #F472B6 100%); }
        #startNumberGuessGameButton { background: linear-gradient(135deg, #34A853 0%, #FBBC05 50%, #F472B6 100%); }
        #startColorTapChallengeButton { background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 50%, #ffcc80 100%); }
        #getGameIdeaButton { 
            background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
            font-size: 1rem; padding: 8px 18px; max-width: 250px;
        }
        #getDailyQuoteButton { /* ì˜¤ëŠ˜ì˜ ëª…ì–¸ ë²„íŠ¼ */
             background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%);
             font-size: 1rem; padding: 8px 18px; max-width: 250px; margin-top: 5px;
        }
        #quoteDisplay, #gameIdeaDisplay { /* ê³µí†µ ë””ìŠ¤í”Œë ˆì´ ì˜ì—­ */
            margin-top: 12px; padding: 10px; background-color: rgba(0,0,0,0.1);
            border-radius: 8px; font-size: 0.9rem; color: #e0e0e0; min-height: 30px;
            text-align: left;
        }


        .taskbar {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background-color: rgba(0,0,0,0.2); padding: 12px 0; text-align: center;
            font-size: 0.9rem; color: #e5e7eb; border-top: 1px solid rgba(255,255,255,0.15); 
            backdrop-filter: blur(5px); cursor: default; 
        }

        /* --- í´ë¦­ ë§ˆìŠ¤í„° ê²Œì„ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #clickerGameScreen { background: linear-gradient(135deg, #b0bec5 0%, #78909c 100%); }
        .game-container { 
            background-color: rgba(255,255,255,0.35); backdrop-filter: blur(16px); border-radius: 28px; 
            padding: 30px 40px 40px 40px; box-shadow: 0 25px 50px rgba(0,0,0,0.15), 
            inset 0 1px 1px rgba(255,255,255,0.2), 0 0 0 1.5px rgba(255,255,255,0.25); 
            text-align: center; width: 90%; max-width: 400px; position: relative; 
        }
        .score-label { font-size: 1.25rem; color: #1A202C; margin-bottom: 8px; font-weight: 500; }
        .score-display {
            font-size: 4.5rem; font-weight: 900; color: #111827; 
            margin-bottom: 24px; line-height: 1;
            transition: transform 0.2s ease, color 0.3s ease, text-shadow 0.3s ease; position: relative; 
        }
        .burning-effect { color: #ffcc00; animation: burningText 1.5s infinite alternate, glow 1.5s infinite alternate; }
        @keyframes burningText { 
            0% { text-shadow: 0 0 5px #fff,0 0 10px #fff,0 0 15px #fff,0 0 20px #ff8c00,0 0 35px #ff8c00,0 0 40px #ff8c00,0 0 50px #ff4500,0 0 75px #ff4500; }
            50% { text-shadow: 0 0 10px #fff,0 0 15px #fff,0 0 20px #ffae42,0 0 30px #ffae42,0 0 40px #ffae42,0 0 50px #ff7700,0 0 60px #ff7700; }
            100% { text-shadow: 0 0 5px #fff,0 0 10px #fff,0 0 15px #ff8c00,0 0 25px #ff8c00,0 0 30px #ff8c00,0 0 40px #ff4500,0 0 55px #ff4500; }
        }
        @keyframes glow { from { opacity: 0.8; } to { opacity: 1; } }
        .click-button { 
            background: linear-gradient(135deg, #4285F4 0%, #9B72F5 25%, #F472B6 50%, #FBBC05 75%, #34A853 100%);
            color: white; font-size: 1.5rem; font-weight: 600; padding: 20px 30px; 
            border: none; border-radius: 16px; cursor: pointer; transition: all 0.2s ease-out; 
            box-shadow: 0 8px 16px rgba(0,0,0,0.2); outline: none; background-size: 200% 200%; 
            animation: rainbowMove 4s ease infinite; -webkit-tap-highlight-color: transparent; 
        }
        @keyframes rainbowMove { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        .click-button:hover { transform: translateY(-4px) scale(1.05); box-shadow: 0 14px 28px rgba(0,0,0,0.25); }
        .click-button:active { transform: translateY(1px) scale(0.96); box-shadow: 0 4px 8px rgba(0,0,0,0.25); }
        .plus-one-animation {
            position: absolute; font-size: 1.75rem; font-weight: bold;
            background: linear-gradient(135deg, #4285F4, #9B72F5, #F472B6);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; text-fill-color: transparent;
            opacity: 0; animation: floatUpFadeOut 0.9s ease-out forwards; pointer-events: none; 
        }
        @keyframes floatUpFadeOut { 0% { opacity:1;transform:translateY(0) scale(0.7); } 100% { opacity:0;transform:translateY(-70px) scale(1.3); } }
        .title { font-size: 2.1rem; font-weight: 700; color: #111827; margin-bottom: 24px; }
        .lucky-message {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8);
            font-size: 2rem; font-weight: bold; color: #FFD700; text-shadow: 0 0 10px #000;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .lucky-message.show { opacity: 1; transform: translate(-50%, -50%) scale(1.1); animation: luckyPulse 0.6s 2 alternate; }
        @keyframes luckyPulse { to { transform: translate(-50%, -50%) scale(1.2); } }
        .game-controls { margin-top: 25px; display: flex; gap: 15px; justify-content: center; }
        .control-button { 
            color: #f8f9fa; font-size: 0.9rem; font-weight: 500; padding: 10px 20px; 
            border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease; outline: none;
        }
        .control-button:active { transform: scale(0.95); }
        #clickerResetButton { background-color: rgba(239,83,80,0.7); } 
        #clickerResetButton:hover { background-color: rgba(229,57,53,0.8); }
        #clickerGoHomeButton, #ngGoHomeButton, #ctcGoHomeButton { background-color: rgba(76,175,80,0.7); } 
        #clickerGoHomeButton:hover, #ngGoHomeButton:hover, #ctcGoHomeButton:hover { background-color: rgba(67,160,71,0.8); }

        /* --- ìˆ«ì ë§ì¶”ê¸° ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        #numberGuessGameScreen { background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%); }
        .number-guess-container { 
            background-color: rgba(255, 255, 255, 0.35); backdrop-filter: blur(16px); border-radius: 28px; 
            padding: 30px 40px 40px 40px; box-shadow: 0 25px 50px rgba(0,0,0,0.15), 
            inset 0 1px 1px rgba(255,255,255,0.2), 0 0 0 1.5px rgba(255,255,255,0.25); 
            text-align: center; width: 90%; max-width: 400px; color: #1A202C;
        }
        .number-guess-container h2 { font-size: 1.8rem; font-weight: 700; margin-bottom: 15px; }
        .number-guess-container p { margin-bottom: 15px; font-size: 1rem; color: #374151; }
        .number-guess-container input[type="number"] {
            width: 80%; padding: 10px; margin-bottom: 15px; border: 1px solid rgba(0,0,0,0.2);
            border-radius: 8px; font-size: 1.1rem; text-align: center; background-color: rgba(255,255,255,0.7); color: #1A202C;
        }
        .number-guess-container .guess-button { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); color: white;
            font-size: 1.1rem; font-weight: 600; padding: 10px 25px; border: none;
            border-radius: 12px; cursor: pointer; transition: all 0.2s ease-out;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2); margin-bottom: 10px; 
        }
        .number-guess-container .guess-button:hover { transform: scale(1.05); }
        
        .number-guess-container .hint-button { 
            background: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
            color: white; font-size: 0.9rem; font-weight: 500; padding: 8px 18px; 
            border: none; border-radius: 10px; cursor: pointer; transition: all 0.2s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); margin-bottom: 15px;
        }
        .number-guess-container .hint-button:hover { transform: scale(1.05); }
        .number-guess-container .hint-button:disabled { background: #ccc; cursor: not-allowed; opacity: 0.7;}


        .number-guess-container .feedback-message { min-height: 24px; margin-bottom: 10px; font-weight: 500; font-size: 1.1rem; }
        .number-guess-container .attempts-display { font-size: 0.9rem; color: #4A5568; margin-bottom: 20px; }
        .ng-controls { margin-top: 15px; display: flex; gap: 15px; justify-content: center; }
        #ngNewGameButton { background-color: rgba(255,167,38,0.8); } 
        #ngNewGameButton:hover { background-color: rgba(251,140,0,0.9); }

        /* --- ì»¬ëŸ¬ íƒ­ ì±Œë¦°ì§€ ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        #colorTapChallengeScreen { background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%); }
        .color-tap-container { 
            background-color: rgba(255, 255, 255, 0.35); 
            backdrop-filter: blur(16px); 
            border-radius: 28px; 
            padding: 20px; 
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15), 
                        inset 0 1px 1px rgba(255, 255, 255, 0.2), 
                        0 0 0 1.5px rgba(255, 255, 255, 0.25); 
            text-align: center;
            width: 90%; 
            max-width: 380px; 
            color: #1A202C;
        }
        .color-tap-container h2 { font-size: 1.6rem; font-weight: 700; margin-bottom: 8px; } 
        .color-tap-container #ctcTargetColorText { font-size: 1.1rem; font-weight: 600; margin-bottom: 12px; min-height: 18px;} 
        .ctc-info-bar { 
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.95rem;
            font-weight: 500;
        }
        #ctcStageDisplay { /* ìŠ¤í…Œì´ì§€ í‘œì‹œ ìŠ¤íƒ€ì¼ */
            font-weight: 600;
            color: #374151;
        }
        .ctc-grid {
            display: grid;
            /* grid-template-columnsëŠ” JSì—ì„œ ë™ì ìœ¼ë¡œ ì„¤ì • */
            gap: 8px; 
            /* width, heightëŠ” JSì—ì„œ ë™ì ìœ¼ë¡œ ì„¤ì • */
            margin: 0 auto 15px auto; 
        }
        .ctc-tile {
            border-radius: 10px; 
            cursor: pointer;
            transition: transform 0.1s ease, opacity 0.3s ease, box-shadow 0.2s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            /* íƒ€ì¼ í¬ê¸°ëŠ” JSì—ì„œ ì„¤ì • */
        }
        .ctc-tile:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 10px rgba(0,0,0,0.15);
        }
        .ctc-tile.found {
            opacity: 0.3;
            cursor: default;
            transform: scale(0.9);
        }
        .ctc-message {
            min-height: 22px; 
            margin-bottom: 12px; 
            font-weight: 500;
            font-size: 1rem; 
        }
        .ctc-controls { margin-top: 10px; display: flex; gap: 10px; justify-content: center; } 
        #ctcNewGameButton { background-color: rgba(255, 167, 38, 0.8); } 
        #ctcNewGameButton:hover { background-color: rgba(251, 140, 0, 0.9); }

    </style>
</head>
<body>
    <div id="nicknameSetupScreen" class="screen">
        <div class="setup-container">
            <div class="setup-logo">ğŸš€</div>
            <h1 class="setup-welcome">í™˜ì˜í•©ë‹ˆë‹¤! ë‹‰ë„¤ì„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”.</h1>
            <input type="text" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ ì…ë ¥ (ìµœëŒ€ 10ì)" maxlength="10">
            <div class="nickname-buttons-container">
                <button id="confirmNicknameButton">ì‹œì‘í•˜ê¸°</button>
                <button id="suggestNicknameButton">âœ¨ ë‹‰ë„¤ì„ ì¶”ì²œë°›ê¸°</button>
            </div>
            <div id="nicknameSuggestions" class="nickname-suggestions-container"></div>
            <div id="nicknameLoading" class="loading-indicator">ë‹‰ë„¤ì„ ì¶”ì²œ ì¤‘...</div>
        </div>
    </div>

    <div id="homeScreen" class="screen">
        <div class="home-content">
            <h1 id="homeAppTitle" class="app-title">ê²Œì„ì¦ˆ</h1> 
            <p class="app-subtitle">ë‹¤ì–‘í•œ ë¯¸ë‹ˆê²Œì„ì„ ì¦ê²¨ë³´ì„¸ìš”!</p>
            <div class="game-selection-buttons">
                <button id="startClickerGameButton" class="game-select-button">í´ë¦­ ë§ˆìŠ¤í„°</button>
                <button id="startNumberGuessGameButton" class="game-select-button">ìˆ«ì ë§ì¶”ê¸°</button>
                <button id="startColorTapChallengeButton" class="game-select-button">ì»¬ëŸ¬ íƒ­ ì±Œë¦°ì§€</button>
                <button id="getGameIdeaButton" class="game-select-button">âœ¨ ìƒˆ ê²Œì„ ì•„ì´ë””ì–´</button>
                <button id="getDailyQuoteButton" class="game-select-button">âœ¨ ì˜¤ëŠ˜ì˜ ëª…ì–¸</button>
            </div>
            <div id="gameIdeaDisplay" class="loading-indicator" style="text-align: left;">ì•„ì´ë””ì–´ êµ¬ìƒ ì¤‘...</div>
            <div id="quoteDisplay" class="loading-indicator" style="text-align: left;">ëª…ì–¸ ë¡œë”© ì¤‘...</div>
        </div>
        <div class="taskbar" id="taskbar"> 
            <span id="taskbarNickname">í”Œë ˆì´ì–´</span><span> - ë©€í‹° ê²Œì„ ì—ë””ì…˜ v3.1</span>
        </div>
    </div>

    <div id="clickerGameScreen" class="screen"> 
        <div class="game-container" id="clickerGameContainer"> 
            <h1 class="title">í´ë¦­ ë§ˆìŠ¤í„°</h1>
            <div class="score-label">í˜„ì¬ ì ìˆ˜</div>
            <div id="clickerScoreDisplay" class="score-display"> 
                0
                <div id="clickerLuckyMessage" class="lucky-message">LUCKY!</div> 
            </div>
            <button id="clickButton" class="click-button">í´ë¦­í•˜ì„¸ìš”!</button>
        </div>
        <div class="game-controls">
            <button id="clickerResetButton" class="control-button">ì ìˆ˜ ì´ˆê¸°í™”</button> 
            <button id="clickerGoHomeButton" class="control-button">í™ˆìœ¼ë¡œ</button> 
        </div>
    </div>

    <div id="numberGuessGameScreen" class="screen">
        <div class="number-guess-container">
            <h2>ìˆ«ì ë§ì¶”ê¸° ê²Œì„</h2>
            <p>1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ë§ì¶°ë³´ì„¸ìš”!</p>
            <input type="number" id="ngGuessInput" min="1" max="100" placeholder="ìˆ«ì ì…ë ¥">
            <button id="ngSubmitGuessButton" class="guess-button">ì¶”ì¸¡í•˜ê¸°!</button>
            <button id="ngHintButton" class="hint-button" disabled>âœ¨ íŒíŠ¸ ë³´ê¸° (3íšŒ ì‹œë„ í›„)</button>
            <div id="ngFeedbackMessage" class="feedback-message"></div>
            <div id="ngAttemptsDisplay" class="attempts-display">ì‹œë„ íšŸìˆ˜: 0</div>
             <div id="ngHintLoading" class="loading-indicator">íŒíŠ¸ ìƒì„± ì¤‘...</div>
            <div class="ng-controls">
                <button id="ngNewGameButton" class="control-button">ìƒˆ ê²Œì„</button>
                <button id="ngGoHomeButton" class="control-button">í™ˆìœ¼ë¡œ</button>
            </div>
        </div>
    </div>

    <div id="colorTapChallengeScreen" class="screen">
        <div class="color-tap-container">
            <h2>ì»¬ëŸ¬ íƒ­ ì±Œë¦°ì§€</h2>
            <div class="ctc-info-bar">
                <span id="ctcStageDisplay">ìŠ¤í…Œì´ì§€: 1</span>
                <span id="ctcTimerDisplay">ì‹œê°„: 10</span>
                <span id="ctcScoreDisplay">ì ìˆ˜: 0</span>
            </div>
            <div id="ctcTargetColorText">ëª©í‘œ ìƒ‰ìƒ: -</div>
            <div id="ctcGrid" class="ctc-grid"></div>
            <div id="ctcMessage" class="ctc-message"></div>
            <div id="ctcHighScoreDisplay" style="font-size: 0.9rem; margin-bottom: 10px;">ìµœê³  ì ìˆ˜: 0</div>
            <div class="ctc-controls">
                <button id="ctcNewGameButton" class="control-button">ìƒˆ ê²Œì„</button>
                <button id="ctcGoHomeButton" class="control-button">í™ˆìœ¼ë¡œ</button>
            </div>
        </div>
    </div>


    <script>
        // --- ê³µí†µ ìš”ì†Œ ---
        const nicknameSetupScreen = document.getElementById('nicknameSetupScreen');
        const nicknameInput = document.getElementById('nicknameInput');
        const confirmNicknameButton = document.getElementById('confirmNicknameButton');
        const suggestNicknameButton = document.getElementById('suggestNicknameButton');
        const nicknameSuggestionsContainer = document.getElementById('nicknameSuggestions');
        const nicknameLoading = document.getElementById('nicknameLoading');

        const homeScreen = document.getElementById('homeScreen');
        const homeAppTitle = document.getElementById('homeAppTitle');
        const taskbar = document.getElementById('taskbar'); 
        const taskbarNickname = document.getElementById('taskbarNickname');
        const getGameIdeaButton = document.getElementById('getGameIdeaButton');
        const gameIdeaDisplay = document.getElementById('gameIdeaDisplay');
        const getDailyQuoteButton = document.getElementById('getDailyQuoteButton');
        const quoteDisplay = document.getElementById('quoteDisplay');
        
        // --- í´ë¦­ ë§ˆìŠ¤í„° ê²Œì„ ìš”ì†Œ ---
        const clickerGameScreen = document.getElementById('clickerGameScreen'); 
        const startClickerGameButton = document.getElementById('startClickerGameButton');
        const clickerScoreDisplay = document.getElementById('clickerScoreDisplay'); 
        const clickButton = document.getElementById('clickButton');
        const clickerGameContainer = document.getElementById('clickerGameContainer'); 
        const clickerLuckyMessage = document.getElementById('clickerLuckyMessage'); 
        const clickerResetButton = document.getElementById('clickerResetButton'); 
        const clickerGoHomeButton = document.getElementById('clickerGoHomeButton'); 

        let clickerScore = 0;
        const CLICKER_BURNING_THRESHOLD = 1000; 
        let clickerDeveloperBurningActive = false;
        const CLICKER_LUCKY_SCORE = 777;
        let clickerEasterEggsEnabled = true; 

        // --- ìˆ«ì ë§ì¶”ê¸° ê²Œì„ ìš”ì†Œ ---
        const numberGuessGameScreen = document.getElementById('numberGuessGameScreen');
        const startNumberGuessGameButton = document.getElementById('startNumberGuessGameButton');
        const ngGuessInput = document.getElementById('ngGuessInput');
        const ngSubmitGuessButton = document.getElementById('ngSubmitGuessButton');
        const ngHintButton = document.getElementById('ngHintButton');
        const ngFeedbackMessage = document.getElementById('ngFeedbackMessage');
        const ngAttemptsDisplay = document.getElementById('ngAttemptsDisplay');
        const ngHintLoading = document.getElementById('ngHintLoading');
        const ngNewGameButton = document.getElementById('ngNewGameButton');
        const ngGoHomeButton = document.getElementById('ngGoHomeButton');

        let ngTargetNumber;
        let ngAttempts;
        const NG_HINT_ATTEMPT_THRESHOLD = 3; 

        // --- ì»¬ëŸ¬ íƒ­ ì±Œë¦°ì§€ ê²Œì„ ìš”ì†Œ ---
        const colorTapChallengeScreen = document.getElementById('colorTapChallengeScreen');
        const startColorTapChallengeButton = document.getElementById('startColorTapChallengeButton');
        const ctcTargetColorText = document.getElementById('ctcTargetColorText');
        const ctcGrid = document.getElementById('ctcGrid');
        const ctcMessage = document.getElementById('ctcMessage');
        const ctcTimerDisplay = document.getElementById('ctcTimerDisplay');
        const ctcScoreDisplay = document.getElementById('ctcScoreDisplay');
        const ctcStageDisplay = document.getElementById('ctcStageDisplay');
        const ctcHighScoreDisplay = document.getElementById('ctcHighScoreDisplay');
        const ctcNewGameButton = document.getElementById('ctcNewGameButton');
        const ctcGoHomeButton = document.getElementById('ctcGoHomeButton');

        const CTC_COLORS = {
            red: { name: 'ë¹¨ê°„ìƒ‰', value: '#EF5350' },
            blue: { name: 'íŒŒë€ìƒ‰', value: '#42A5F5' },
            green: { name: 'ì´ˆë¡ìƒ‰', value: '#66BB6A' },
            yellow: { name: 'ë…¸ë€ìƒ‰', value: '#FFEE58' },
            purple: { name: 'ë³´ë¼ìƒ‰', value: '#AB47BC' },
            orange: { name: 'ì£¼í™©ìƒ‰', value: '#FFA726'},
            pink: { name: 'ë¶„í™ìƒ‰', value: '#EC407A'},
            teal: { name: 'ì²­ë¡ìƒ‰', value: '#26A69A'}
        };
        const CTC_COLOR_KEYS = Object.keys(CTC_COLORS);
        let ctcCurrentTargetColor;
        let ctcTargetTilesCount;
        let ctcFoundTilesCount;
        let ctcTimerInterval;
        let ctcTimeLeft;
        let ctcCurrentScore;
        let ctcHighScore = 0;
        let ctcCurrentStage = 1;
        const CTC_INITIAL_TIME_LIMIT = 10; // ì´ˆê¸° ì‹œê°„ ì œí•œ
        const CTC_GRID_CONFIGS = [ // ìŠ¤í…Œì´ì§€ë³„ ê·¸ë¦¬ë“œ ì„¤ì •
            { stage: 1, rows: 3, cols: 3, time: 10 }, // 3x3, 10ì´ˆ
            { stage: 2, rows: 3, cols: 3, time: 9 },
            { stage: 3, rows: 3, cols: 4, time: 12 }, // 3x4, 12ì´ˆ
            { stage: 4, rows: 3, cols: 4, time: 11 },
            { stage: 5, rows: 4, cols: 4, time: 15 }, // 4x4, 15ì´ˆ
            { stage: 6, rows: 4, cols: 4, time: 13 },
            { stage: 7, rows: 4, cols: 5, time: 18 }, // 4x5, 18ì´ˆ
            { stage: 8, rows: 4, cols: 5, time: 16 },
            { stage: 9, rows: 5, cols: 5, time: 20 }, // 5x5, 20ì´ˆ
            { stage: 10, rows: 5, cols: 5, time: 18 } // ìµœì¢… ìŠ¤í…Œì´ì§€
        ];


        // --- ê°œë°œì ì„¤ì • ê´€ë ¨ ë³€ìˆ˜ ---
        let typedAdminSequence = ""; 
        const ADMIN_KEY_SEQUENCE = "admin";


        let userNickname = '';

        // --- Gemini API ê´€ë ¨ ---
        const GEMINI_API_KEY = ""; 

        async function callGeminiAPI(prompt) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;
            const payload = {
                contents: [{ role: "user", parts: [{ text: prompt }] }]
            };
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Gemini API Error:", errorData);
                    throw new Error(`HTTP error! status: ${response.status}, message: ${errorData.error?.message || 'Unknown error'}`);
                }
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Gemini API Error: Unexpected response structure", result);
                    throw new Error("ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ êµ¬ì¡°ì…ë‹ˆë‹¤.");
                }
            } catch (error) {
                console.error("Gemini API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                return null; 
            }
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            const nextScreen = document.getElementById(screenId);
            if (nextScreen) {
                nextScreen.classList.add('active');
            }
        }

        function loadNickname() {
            const savedNickname = localStorage.getItem('userNickname');
            if (savedNickname) {
                userNickname = savedNickname;
                updateUIWithNickname();
                showScreen('homeScreen');
            } else {
                showScreen('nicknameSetupScreen');
            }
        }

        function saveNickname(nickname) {
            localStorage.setItem('userNickname', nickname);
            userNickname = nickname;
            updateUIWithNickname();
        }

        function updateUIWithNickname() {
            homeAppTitle.textContent = `${userNickname}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`;
            taskbarNickname.textContent = userNickname;
        }


        document.addEventListener('DOMContentLoaded', () => {
            loadNickname(); 
            initializeClickerGame(); 
            loadCTCHighScore();
            
            confirmNicknameButton.addEventListener('click', () => {
                const nickname = nicknameInput.value.trim();
                if (nickname) {
                    saveNickname(nickname);
                    showScreen('homeScreen');
                } else {
                    nicknameInput.focus();
                    nicknameInput.style.border = '2px solid red';
                    setTimeout(() => { nicknameInput.style.border = 'none'; }, 2000);
                }
            });
            nicknameInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    confirmNicknameButton.click();
                }
            });

            suggestNicknameButton.addEventListener('click', async () => {
                nicknameLoading.style.display = 'block';
                nicknameSuggestionsContainer.innerHTML = '';
                const prompt = "ì¬ë¯¸ìˆê³  ë…íŠ¹í•œ ê²Œì„ ë‹‰ë„¤ì„ 3ê°œë¥¼ ì¶”ì²œí•´ì¤˜. ê° ë‹‰ë„¤ì„ì€ í•œê¸€ ë˜ëŠ” ì˜ì–´ë¡œ, ì§§ê³  ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ê²ƒìœ¼ë¡œ í•´ì¤˜. ìˆ«ìë‚˜ íŠ¹ìˆ˜ë¬¸ìëŠ” ì‚¬ìš©í•˜ì§€ ë§ì•„ì¤˜. ì˜ˆì‹œ: ìŠˆí¼í† ë¼, CosmicDrifter, ë²ˆê°œì†";
                try {
                    const suggestionsText = await callGeminiAPI(prompt);
                    if (suggestionsText) {
                        const suggestions = suggestionsText.split('\n').map(s => s.replace(/^[0-9]+\.\s*/, '').trim()).filter(s => s.length > 0 && s.length <= 10);
                        if (suggestions.length > 0) {
                            suggestions.slice(0, 3).forEach(suggestion => { 
                                const btn = document.createElement('button');
                                btn.textContent = suggestion;
                                btn.onclick = () => {
                                    nicknameInput.value = suggestion;
                                };
                                nicknameSuggestionsContainer.appendChild(btn);
                            });
                        } else {
                            nicknameSuggestionsContainer.textContent = 'ì¶”ì²œ ë‹‰ë„¤ì„ì„ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆì–´ìš”. ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                        }
                    } else {
                        nicknameSuggestionsContainer.textContent = 'ë‹‰ë„¤ì„ ì¶”ì²œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.';
                    }
                } catch (error) {
                     nicknameSuggestionsContainer.textContent = 'ë‹‰ë„¤ì„ ì¶”ì²œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.';
                } finally {
                    nicknameLoading.style.display = 'none';
                }
            });

            let clickerActiveTouches = 0;
            clickButton.addEventListener('touchstart', (event) => {
                if (!clickerGameScreen.classList.contains('active')) return; 
                clickerActiveTouches = event.touches.length;
                if (clickerActiveTouches === 3) { 
                    event.preventDefault(); 
                    clickerDeveloperBurningActive = !clickerDeveloperBurningActive; 
                    updateClickerScoreDisplay(); 
                    console.log(`í´ë¦­ ë§ˆìŠ¤í„° ê°œë°œì: ë²„ë‹ íš¨ê³¼ ${clickerDeveloperBurningActive ? 'ê°•ì œ í™œì„±í™”' : 'ê°•ì œ ë¹„í™œì„±í™”'}`);
                } 
            });
            clickButton.addEventListener('touchend', (event) => { if (clickerGameScreen.classList.contains('active')) clickerActiveTouches = event.touches.length; });
            clickButton.addEventListener('touchcancel', (event) => { if (clickerGameScreen.classList.contains('active')) clickerActiveTouches = event.touches.length; });
        
            startClickerGameButton.addEventListener('click', () => {
                initializeClickerGame(); 
                showScreen('clickerGameScreen');
            });
            startNumberGuessGameButton.addEventListener('click', () => {
                initializeNumberGuessGame();
                showScreen('numberGuessGameScreen');
            });
            startColorTapChallengeButton.addEventListener('click', () => {
                initializeColorTapChallengeGame();
                showScreen('colorTapChallengeScreen');
            });
            getGameIdeaButton.addEventListener('click', async () => {
                gameIdeaDisplay.classList.remove('loading-indicator'); 
                gameIdeaDisplay.textContent = 'ìƒˆë¡œìš´ ê²Œì„ ì•„ì´ë””ì–´ êµ¬ìƒ ì¤‘...';
                gameIdeaDisplay.style.display = 'block';
                quoteDisplay.style.display = 'none'; // ëª…ì–¸ ìˆ¨ê¸°ê¸°
                const prompt = "ê°„ë‹¨í•˜ê³  ì¬ë¯¸ìˆëŠ” ì›¹ ë¸Œë¼ìš°ì € ë¯¸ë‹ˆê²Œì„ ì•„ì´ë””ì–´ë¥¼ í•˜ë‚˜ ì œì•ˆí•˜ê³ , ê·¸ ê²Œì„ì˜ í•µì‹¬ ê·œì¹™ì„ í•œë‘ ë¬¸ì¥ìœ¼ë¡œ ì„¤ëª…í•´ì¤˜.";
                try {
                    const idea = await callGeminiAPI(prompt);
                    if (idea) {
                        gameIdeaDisplay.textContent = `âœ¨ ì¶”ì²œ ê²Œì„ ì•„ì´ë””ì–´: ${idea}`;
                    } else {
                        gameIdeaDisplay.textContent = 'ì•„ì´ë””ì–´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    }
                } catch (error) {
                    gameIdeaDisplay.textContent = 'ì•„ì´ë””ì–´ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ.';
                }
            });
             getDailyQuoteButton.addEventListener('click', async () => {
                quoteDisplay.classList.remove('loading-indicator');
                quoteDisplay.textContent = 'ì˜¤ëŠ˜ì˜ ëª…ì–¸ ë¡œë”© ì¤‘...';
                quoteDisplay.style.display = 'block';
                gameIdeaDisplay.style.display = 'none'; // ê²Œì„ ì•„ì´ë””ì–´ ìˆ¨ê¸°ê¸°
                const prompt = "ì§§ê³  ì˜ê°ì„ ì£¼ëŠ” ì˜¤ëŠ˜ì˜ ëª…ì–¸ í•œë§ˆë””ë¥¼ ì¶”ì²œí•´ì¤˜. (í•œê¸€ ë˜ëŠ” ì˜ì–´)";
                try {
                    const quote = await callGeminiAPI(prompt);
                    if (quote) {
                        quoteDisplay.textContent = `âœ¨ ì˜¤ëŠ˜ì˜ ëª…ì–¸: "${quote}"`;
                    } else {
                        quoteDisplay.textContent = 'ëª…ì–¸ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    }
                } catch (error) {
                    quoteDisplay.textContent = 'ëª…ì–¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ.';
                }
            });


            clickerResetButton.addEventListener('click', () => {
                console.log("í´ë¦­ ë§ˆìŠ¤í„° ë¦¬ì…‹!");
                initializeClickerGame();
            });
            clickerGoHomeButton.addEventListener('click', () => {
                showScreen('homeScreen');
            });
            clickButton.addEventListener('click', handleRegularClick); 

            ngSubmitGuessButton.addEventListener('click', handleNumberGuess);
            ngGuessInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    handleNumberGuess();
                }
            });
            ngNewGameButton.addEventListener('click', initializeNumberGuessGame);
            ngGoHomeButton.addEventListener('click', () => {
                showScreen('homeScreen');
            });
            ngHintButton.addEventListener('click', async () => {
                ngHintLoading.style.display = 'block';
                ngHintButton.disabled = true;
                const prompt = `1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ì ë§ì¶”ê¸° ê²Œì„ì˜ ì •ë‹µì€ ${ngTargetNumber}ì…ë‹ˆë‹¤. ì´ ìˆ«ìì— ëŒ€í•œ ì°½ì˜ì ì´ê³  ê°„ì ‘ì ì¸ íŒíŠ¸ë¥¼ í•˜ë‚˜ë§Œ ì§§ê²Œ ì œê³µí•´ì£¼ì„¸ìš”. ì§ì ‘ì ìœ¼ë¡œ ìˆ«ìë¥¼ ì–¸ê¸‰í•˜ê±°ë‚˜ ê³„ì‚°ì„ ìœ ë„í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì •ë‹µì´ 25ë¼ë©´ "ì´ ìˆ«ìëŠ” ì–´ë–¤ ìˆ«ìì˜ ì œê³±ìˆ˜ì´ê³ , ë™ì „ ì´ë¦„ê³¼ë„ ê´€ë ¨ì´ ìˆì–´ìš”." ì™€ ê°™ì´ ë§í•´ì£¼ì„¸ìš”.`;
                try {
                    const hint = await callGeminiAPI(prompt);
                    if (hint) {
                        ngFeedbackMessage.textContent = `âœ¨ íŒíŠ¸: ${hint}`;
                        ngFeedbackMessage.style.color = '#007bff'; 
                    } else {
                        ngFeedbackMessage.textContent = 'íŒíŠ¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆì–´ìš”.';
                        ngFeedbackMessage.style.color = 'red';
                        ngHintButton.disabled = false; 
                    }
                } catch (error) {
                    ngFeedbackMessage.textContent = 'íŒíŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ.';
                    ngFeedbackMessage.style.color = 'red';
                    ngHintButton.disabled = false;
                } finally {
                    ngHintLoading.style.display = 'none';
                }
            });

            ctcNewGameButton.addEventListener('click', initializeColorTapChallengeGame);
            ctcGoHomeButton.addEventListener('click', () => {
                showScreen('homeScreen');
            });

            document.addEventListener('keydown', (event) => {
                if (event.target === nicknameInput || event.target === ngGuessInput) {
                    typedAdminSequence = ""; 
                    return;
                }
                typedAdminSequence += event.key.toLowerCase();
                if (typedAdminSequence.length > ADMIN_KEY_SEQUENCE.length) {
                    typedAdminSequence = typedAdminSequence.slice(-ADMIN_KEY_SEQUENCE.length);
                }
                if (typedAdminSequence === ADMIN_KEY_SEQUENCE) {
                    clickerEasterEggsEnabled = !clickerEasterEggsEnabled;
                    console.log(`ê°œë°œì ê¸°ëŠ¥ (í‚¤ë³´ë“œ 'admin'): í´ë¦­ ë§ˆìŠ¤í„° ì´ìŠ¤í„°ì—ê·¸ ${clickerEasterEggsEnabled ? 'í™œì„±í™”ë¨' : 'ë¹„í™œì„±í™”ë¨'}`);
                    if (!clickerEasterEggsEnabled && clickerLuckyMessage.classList.contains('show')) {
                        clickerLuckyMessage.classList.remove('show');
                        if (!clickerScoreDisplay.classList.contains('burning-effect')) {
                            clickerScoreDisplay.style.color = '#111827'; 
                        } else {
                            clickerScoreDisplay.style.color = '#ffcc00'; 
                        }
                    }
                    typedAdminSequence = ""; 
                }
            });
        });
        
        function initializeClickerGame() {
            clickerScore = 0;
            clickerDeveloperBurningActive = false; 
            updateClickerScoreDisplay();
            if(clickerLuckyMessage.classList.contains('show')) {
                clickerLuckyMessage.classList.remove('show');
                if (!clickerScoreDisplay.classList.contains('burning-effect')) {
                     clickerScoreDisplay.style.color = '#111827'; 
                } else {
                     clickerScoreDisplay.style.color = '#ffcc00';
                }
            }
        }
        
        function handleRegularClick(event) { 
            if (event.touches && event.touches.length > 1) { 
                return;
            }
            clickerScore += 1; 
            updateClickerScoreDisplay();
            animateClickerScore(); 
            showClickerPlusAnimation(event); 
            checkClickerEasterEggs();
        }

        function updateClickerScoreDisplay() {
            clickerScoreDisplay.firstChild.textContent = clickerScore; 
            if (clickerDeveloperBurningActive) {
                clickerScoreDisplay.classList.add('burning-effect');
            } else {
                if (clickerScore >= CLICKER_BURNING_THRESHOLD) {
                    clickerScoreDisplay.classList.add('burning-effect');
                } else {
                    clickerScoreDisplay.classList.remove('burning-effect');
                }
            }
        }

        function animateClickerScore() {
            clickerScoreDisplay.style.transform = 'scale(1.12)'; 
            setTimeout(() => {
                clickerScoreDisplay.style.transform = 'scale(1)';
            }, 120); 
        }

        function showClickerPlusAnimation(event) { 
            const plusAnim = document.createElement('div');
            plusAnim.textContent = `+1`; 
            plusAnim.classList.add('plus-one-animation'); 
            
            const gameRect = clickerGameContainer.getBoundingClientRect(); 
            const buttonRect = clickButton.getBoundingClientRect();
            
            const y = (buttonRect.top - gameRect.top) - 15; 

            plusAnim.style.left = `${buttonRect.left + buttonRect.width / 2 - gameRect.left}px`; 
            plusAnim.style.top = `${y}px`;
            
            clickerGameContainer.appendChild(plusAnim); 

            plusAnim.addEventListener('animationend', () => {
                plusAnim.remove();
            });
        }

        function checkClickerEasterEggs() {
            if (!clickerEasterEggsEnabled) {
                if (clickerLuckyMessage.classList.contains('show')) {
                    clickerLuckyMessage.classList.remove('show');
                    if (!clickerScoreDisplay.classList.contains('burning-effect')) {
                        clickerScoreDisplay.style.color = '#111827'; 
                    } else {
                        clickerScoreDisplay.style.color = '#ffcc00';
                    }
                }
                return;
            }

            if (clickerScore === CLICKER_LUCKY_SCORE && !clickerLuckyMessage.classList.contains('show')) {
                clickerScoreDisplay.style.color = '#FFD700'; 
                clickerLuckyMessage.classList.add('show');
                
                setTimeout(() => {
                    clickerLuckyMessage.classList.remove('show');
                    if (!clickerScoreDisplay.classList.contains('burning-effect')) {
                         clickerScoreDisplay.style.color = '#111827'; 
                    } else {
                        clickerScoreDisplay.style.color = '#ffcc00'; 
                    }
                }, 2000); 
            }
        }

        function initializeNumberGuessGame() {
            ngTargetNumber = Math.floor(Math.random() * 100) + 1;
            ngAttempts = 0;
            ngFeedbackMessage.textContent = '';
            ngAttemptsDisplay.textContent = 'ì‹œë„ íšŸìˆ˜: 0';
            ngGuessInput.value = '';
            ngGuessInput.disabled = false;
            ngSubmitGuessButton.disabled = false;
            ngHintButton.disabled = true; 
            ngFeedbackMessage.style.color = '#1A202C'; 
            console.log(`ìˆ«ì ë§ì¶”ê¸° ê²Œì„ ì‹œì‘! ì •ë‹µ: ${ngTargetNumber}`); 
        }

        function handleNumberGuess() {
            const userGuess = parseInt(ngGuessInput.value);
            if (isNaN(userGuess) || userGuess < 1 || userGuess > 100) {
                ngFeedbackMessage.textContent = '1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
                ngFeedbackMessage.style.color = 'red';
                return;
            }

            ngAttempts++;
            ngAttemptsDisplay.textContent = `ì‹œë„ íšŸìˆ˜: ${ngAttempts}`;
            ngFeedbackMessage.style.color = '#1A202C'; 

            if (userGuess < ngTargetNumber) {
                ngFeedbackMessage.textContent = 'ë„ˆë¬´ ë‚®ì•„ìš”! ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.';
            } else if (userGuess > ngTargetNumber) {
                ngFeedbackMessage.textContent = 'ë„ˆë¬´ ë†’ì•„ìš”! ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.';
            } else {
                ngFeedbackMessage.textContent = `ì •ë‹µì…ë‹ˆë‹¤! ${ngAttempts}ë²ˆ ë§Œì— ë§ì¶”ì…¨ì–´ìš”!`;
                ngFeedbackMessage.style.color = 'green';
                ngGuessInput.disabled = true;
                ngSubmitGuessButton.disabled = true;
                ngHintButton.disabled = true;
            }
            ngGuessInput.value = ''; 
            ngGuessInput.focus(); 

            if (ngAttempts >= NG_HINT_ATTEMPT_THRESHOLD && !ngSubmitGuessButton.disabled) {
                ngHintButton.disabled = false;
            }
        }

        // --- ì»¬ëŸ¬ íƒ­ ì±Œë¦°ì§€ ê²Œì„ í•¨ìˆ˜ ---
        function initializeColorTapChallengeGame() {
            ctcCurrentScore = 0;
            ctcCurrentStage = 1;
            updateCTCScoreDisplay();
            updateCTCStageDisplay();
            ctcMessage.textContent = '';
            loadCTCHighScore();
            setupNewColorTapRound();
        }

        function loadCTCHighScore() {
            const savedHighScore = localStorage.getItem('ctcHighScore');
            if (savedHighScore) {
                ctcHighScore = parseInt(savedHighScore, 10);
            }
            ctcHighScoreDisplay.textContent = `ìµœê³  ì ìˆ˜: ${ctcHighScore}`;
        }

        function saveCTCHighScore() {
            if (ctcCurrentScore > ctcHighScore) {
                ctcHighScore = ctcCurrentScore;
                localStorage.setItem('ctcHighScore', ctcHighScore);
                ctcHighScoreDisplay.textContent = `ìµœê³  ì ìˆ˜: ${ctcHighScore}`;
            }
        }
        
        function updateCTCScoreDisplay() {
            ctcScoreDisplay.textContent = `ì ìˆ˜: ${ctcCurrentScore}`;
        }
        function updateCTCStageDisplay() {
            ctcStageDisplay.textContent = `ìŠ¤í…Œì´ì§€: ${ctcCurrentStage}`;
        }


        function startCTCTimer() {
            const currentStageConfig = CTC_GRID_CONFIGS[Math.min(ctcCurrentStage -1, CTC_GRID_CONFIGS.length -1)];
            ctcTimeLeft = currentStageConfig.time;

            ctcTimerDisplay.textContent = `ì‹œê°„: ${ctcTimeLeft}`;
            clearInterval(ctcTimerInterval); 
            ctcTimerInterval = setInterval(() => {
                ctcTimeLeft--;
                ctcTimerDisplay.textContent = `ì‹œê°„: ${ctcTimeLeft}`;
                if (ctcTimeLeft <= 0) {
                    clearInterval(ctcTimerInterval);
                    handleCTCTimeUp();
                }
            }, 1000);
        }

        function handleCTCTimeUp() {
            ctcMessage.textContent = `ì‹œê°„ ì´ˆê³¼! ìµœì¢… ì ìˆ˜: ${ctcCurrentScore}`;
            ctcMessage.style.color = 'red';
            ctcGrid.innerHTML = '<p style="grid-column: 1 / -1; align-self: center; font-weight: bold;">ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.</p>'; 
            saveCTCHighScore();
            // ëª¨ë“  íƒ€ì¼ í´ë¦­ ë¹„í™œì„±í™”
            document.querySelectorAll('.ctc-tile').forEach(tile => tile.removeEventListener('click', handleColorTileTap));
        }


        function setupNewColorTapRound() {
            ctcGrid.innerHTML = ''; 
            const currentStageConfig = CTC_GRID_CONFIGS[Math.min(ctcCurrentStage -1, CTC_GRID_CONFIGS.length -1)];
            const rows = currentStageConfig.rows;
            const cols = currentStageConfig.cols;
            const totalTiles = rows * cols;

            ctcGrid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            ctcGrid.style.width = `${cols * 65 + (cols -1) * 8}px`; // íƒ€ì¼ í¬ê¸° 65px, ê°„ê²© 8px ê¸°ì¤€
            ctcGrid.style.height = `${rows * 65 + (rows -1) * 8}px`;


            const availableColors = [...CTC_COLOR_KEYS];
            const targetColorKey = availableColors[Math.floor(Math.random() * availableColors.length)];
            ctcCurrentTargetColor = CTC_COLORS[targetColorKey];
            ctcTargetColorText.textContent = `ëª©í‘œ ìƒ‰ìƒ: ${ctcCurrentTargetColor.name}`;
            ctcTargetColorText.style.color = ctcCurrentTargetColor.value; 
            ctcTargetTilesCount = 0;
            ctcFoundTilesCount = 0;
            ctcMessage.textContent = `${ctcCurrentTargetColor.name} íƒ€ì¼ì„ ëª¨ë‘ ì°¾ìœ¼ì„¸ìš”!`;
            ctcMessage.style.color = '#1A202C'; 

            let tempTargetTiles = 0;
            // ëª©í‘œ íƒ€ì¼ ìµœì†Œ ê°œìˆ˜ (ê·¸ë¦¬ë“œ í¬ê¸°ì— ë”°ë¼ ì¡°ì ˆ)
            const minTargetTiles = Math.max(2, Math.floor(totalTiles / 5)); 
            
            while (tempTargetTiles < minTargetTiles) { 
                ctcGrid.innerHTML = ''; 
                tempTargetTiles = 0;
                for (let i = 0; i < totalTiles; i++) {
                    const tile = document.createElement('div');
                    tile.classList.add('ctc-tile');
                    tile.style.width = '65px'; // íƒ€ì¼ í¬ê¸° ê³ ì •
                    tile.style.height = '65px';
                    
                    // ëª©í‘œ íƒ€ì¼ ìƒì„± í™•ë¥  (ê·¸ë¦¬ë“œ í¬ê¸°ì— ë”°ë¼ ì¡°ì ˆ ê°€ëŠ¥)
                    const isTarget = Math.random() < (minTargetTiles * 1.5 / totalTiles) ; // ëª©í‘œ íƒ€ì¼ì´ ë„ˆë¬´ ì ê±°ë‚˜ ë§ì§€ ì•Šë„ë¡ í™•ë¥  ì¡°ì •
                    let tileColorKey;
                    if (isTarget) {
                        tileColorKey = targetColorKey;
                        tempTargetTiles++;
                    } else {
                        let randomColorKey = availableColors[Math.floor(Math.random() * availableColors.length)];
                        while (randomColorKey === targetColorKey) { 
                            randomColorKey = availableColors[Math.floor(Math.random() * availableColors.length)];
                        }
                        tileColorKey = randomColorKey;
                    }
                    
                    tile.style.backgroundColor = CTC_COLORS[tileColorKey].value;
                    tile.dataset.colorKey = tileColorKey; 

                    tile.addEventListener('click', handleColorTileTap);
                    ctcGrid.appendChild(tile);
                }
            }
            ctcTargetTilesCount = tempTargetTiles; 
            startCTCTimer(); 
        }

        function handleColorTileTap(event) {
            if (ctcTimeLeft <= 0) return; 

            const tappedTile = event.target;
            if (tappedTile.classList.contains('found')) {
                return; 
            }

            const tappedColorKey = tappedTile.dataset.colorKey;

            if (tappedColorKey === ctcCurrentTargetColor.key || CTC_COLORS[tappedColorKey].value === ctcCurrentTargetColor.value) {
                tappedTile.classList.add('found');
                ctcFoundTilesCount++;
                ctcCurrentScore += 10; 
                updateCTCScoreDisplay();
                ctcMessage.textContent = 'ì •ë‹µì…ë‹ˆë‹¤!';
                ctcMessage.style.color = 'green';
                tappedTile.style.border = `3px solid ${darkenColor(CTC_COLORS[tappedColorKey].value, 0.7)}`; 
                tappedTile.style.transform = 'scale(0.9)';


                if (ctcFoundTilesCount === ctcTargetTilesCount) {
                    clearInterval(ctcTimerInterval); 
                    ctcCurrentScore += Math.max(0, ctcTimeLeft * 2); // ë‚¨ì€ ì‹œê°„ ë³´ë„ˆìŠ¤ ì ìˆ˜
                    updateCTCScoreDisplay();
                    ctcMessage.textContent = 'ì„±ê³µ! ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ!';
                    ctcMessage.style.color = 'blue';
                    saveCTCHighScore(); 
                    ctcCurrentStage++;
                    updateCTCStageDisplay();
                    setTimeout(setupNewColorTapRound, 1500); 
                }
            } else {
                ctcMessage.textContent = 'ë•¡! ë‹¤ë¥¸ ìƒ‰ìƒì…ë‹ˆë‹¤.';
                ctcMessage.style.color = 'orange';
                ctcCurrentScore -= 5; // ì˜¤ë‹µ ì‹œ ê°ì 
                if (ctcCurrentScore < 0) ctcCurrentScore = 0;
                updateCTCScoreDisplay();
                tappedTile.animate([
                    { transform: 'translateX(-5px)' }, { transform: 'translateX(5px)' },
                    { transform: 'translateX(-5px)' }, { transform: 'translateX(0px)' }
                ], { duration: 300, iterations: 1 });
            }
        }
        function darkenColor(hex, percent) {
            hex = hex.replace(/^#/, '');
            let r = parseInt(hex.substring(0, 2), 16);
            let g = parseInt(hex.substring(2, 4), 16);
            let b = parseInt(hex.substring(4, 6), 16);
            r = Math.floor(r * (1 - percent));
            g = Math.floor(g * (1 - percent));
            b = Math.floor(b * (1 - percent));
            return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;
        }
        
        function initializeColorTapChallengeGame() { 
            ctcCurrentScore = 0; 
            ctcCurrentStage = 1; // ìŠ¤í…Œì´ì§€ ì´ˆê¸°í™”
            updateCTCScoreDisplay();
            updateCTCStageDisplay(); // ìŠ¤í…Œì´ì§€ í‘œì‹œ ì—…ë°ì´íŠ¸
            loadCTCHighScore(); 
            ctcMessage.textContent = '';
            setupNewColorTapRound();
        }


    </script>
</body>
</html>
